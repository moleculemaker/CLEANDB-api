# Default values for mmli-cleandb-api
# This is a YAML-formatted file.
# Declare variables to be passed into your templates.


# Arbitrary configuration, unique to this application
config:
  # Defined as an encrypted SealedSecret (see below)
  # NOTE: This overrides the hardcoded values below
  existingSecret: moldb-cleandb-api

  # Alternatively, you can hardcode the values here instead (for local development only)
  # These are ignored if existingSecret is defined above
  CLEAN_DB_USER: 'molfront'
  CLEAN_DB_PASSWORD: ''   # See SealedSecret below
  CLEAN_DB_HOST: 'moldb-fastapi-postgresql.moldb.svc.cluster.local'
  CLEAN_DB_PORT: '5432'
  CLEAN_DB_NAME: 'molfront'


# The Deployment captures everything about the container that will run
controller:
  # Define how many replicas of this application should run
  replicas: 1

  # Define which Docker image should be run for this application (container)
  image:
    repository: moleculemaker/mmli-cleandb-api
    pullPolicy: Always
    #pullSecrets: []

  # TODO: parameterize labels, tolerations, nodeSelector, resources, etc?


# Define how to access this application over the network
# The Service creates a static IP that will round-robin requests to the different replicas
service:
  type: ClusterIP
  protocol: TCP
  port: 8000


# Define whether / how to access this application over the public internet
ingress:
  enabled: true
  hostname: "fastapi.cleandb.mmli1.ncsa.illinois.edu"
  tls: true
  className: traefik
  annotations:
    # Automatically issue a TLS certificate for this ingress hostname
    kubernetes.io/tls-acme: "true"
    cert-manager.io/cluster-issuer: letsencrypt-production

    # Define Traefik strict TLS rules and Middlewares for ForwardAuth
    kubernetes.io/ingress.class: traefik
    traefik.ingress.kubernetes.io/router.tls: "true"

    # No keycloak group auth:
    traefik.ingress.kubernetes.io/router.middlewares: openenzymedb-oed-staging-cors-header@kubernetescrd

    # For keycloak group auth:
    #traefik.ingress.kubernetes.io/router.middlewares: openenzymedb-oed-staging-cors-header@kubernetescrd,openenzymedb-oed-staging-redirect-to-login@kubernetescrd,openenzymedb-oed-staging-private-auth@kubernetescrd


# TODO: in the future if this is split into prod/staging, this secret would likely be for staging
# Additional Kubernetes resources to deploy along with this Helm chart
# SealedSecrets, Middlewares, Volume definitions, etc
extraDeploy:
  # First, we build up in plaintext the Secret that we would like to encrypt (seal)
  # After building up a raw Secret, the cluster admin can encrypt them using the following command:
  #     kubeseal --format yaml < mmli-cleandb-api.moldb.secret.yaml > mmli-cleandb-api.moldb.sealedsecret.yaml
  # SealedSecrets can only be decrypted (unsealed) by our cluster's private key
  # This Secret will be automatically decrypted by our cluster, making it available to our application
  - apiVersion: bitnami.com/v1alpha1
    kind: SealedSecret
    metadata:
      creationTimestamp: null
      name: moldb-cleandb-api
      namespace: openenzymedb
    spec:
      encryptedData:
        CLEAN_DB_HOST: AgBjSHX9qWGtAZxEknWFYGHAQ8FUha8BNLZuhw7wlgtat11EqnK5x2mCz7S+5vw8HUn4YdFoyocxWAOHx9NGNIiGcdNYjcZtbUWuwrsEEUJY21t2bzPupUbFIH9RmtM0iT0k+MoCnvHA0kF3X0DvExIbhVqMZP1qtKopzjC+8UQFcAwbd44FJw7ITBUdZQukSh2kOLgfNQ9bSQtfR0/uZMNsZ+O9JuUxEfsE4xtEaQlikvtjUFcImbF9zjm9gVgKMulyg0/KOKKeKEG8bNUwZVBxbWSbvMCoV9usR4+LAzPNGMSwqhgI6bsIIEiSnC8gmhoniOEH1/0tcwb3NR5JaYhHhIWj8lb7YrzVjat0X1mxVp34O8EGi/Ct0Qn7sse1gWJO851NZK2rVEmFF6axly+wi+iIR6ItFTuxNa5ik9wTbdCFp5ab5H9BKnY3wxTqoZNL00NCXrDxw636VI2pn8W106dbt74y/gwERQo5Revb30Lw10pLzgv0Vzwy4y3+Qi5E1fsrsmTYJo3LI8c+3ifhoxt2UQeV7Fk22qMqsVx4S3omPBix0zac9meDsw7zDuC7WrgtOGLCgIeheY30tyPicuiefSYCaD3bF8fi3LfFyTJ2Sjpb+VEBcLg01dtcPQcmeYJz2I73weuQO14pWHefOk1bIsOLeT5aLlTe/9IaFweX8IAfAvLxJMATqXg0gAM9hRz69vBFuAua7vOEPJiTtRpUJot7s4ymA9T5nEPS8xRoku0FMOgQmBjiLqT5UgA=
        CLEAN_DB_NAME: AgBWCI6oa7D54vwPSRZrL1tBw6PdL3L3NqqWhAg5NOvaL4lOtj43HmFDYU9d197dWJAwgtYRNlDuvzikDzs9zPzY7toqKDHAR17Lc8I7Zdn8imI5A35fymPzQR//ZEt6N9V0H9XEIhSClzLOCAgpwG2Dkp+I3/qVPPWGcEO55TRCwaauMzPFccshGR21FlRAqHCPa+AcYOkT7WYMe8t2zfz3UHd8C/uNcHmJwkFkSzalC8RcTKY8ZpwkeowVuahhXcc5+YX0hq8tSD1RZ+nelYlLgqJ702HWf1vtJi3o2uT7TGbBbtm8dVOca0UsJVPg8MdEn9FhytdDwdmYJDMMD7aKrCMeL4mZZV6Oyrt7ntUknkcl8aSmZeEQ5RYZyJmoRx2AHXDpvURtxsXWVhK3FtT+YAlFZuGPDnk/kWJ99kL4j1QCbHJrp7NWIzctfU3m8YNzPiH0UlvhtzP7hXyWhg2Iuz+fGePcBQw6bt2L9It+v9sX/+fU6oCcVNMr97FLS46wqQxWZ0JyoIXlXLwv1J9OsX2Tc9jjyjBAbCB7ctlr+d9k+9cNihcnViOEpyHtGqSk4RHSLz4SoK7jlLgIQ+y/QdUKfI//LVvKq4lCt3WKTil3tlMz9RShoeyF4d9ptklQMzx8CKkt7NabSG98PndWecv0XuBk4uzJ/egDIIhgsTeY1XlJLx1A8Mmbpkz+gDFNtA8zdnvdIQ==
        CLEAN_DB_PASSWORD: AgAKLdNSaIlqJzhH+o/BifwQvA4j6rWJ/YXpXmmWQtHP75Tz5UpXItGtg38qRUQ/2JGxFPvAjg7vVviryLkBuFhv1V1Jj7ED8ILdmSBEqPGUT71NsN2583xy2swNYniRlpuOgqZqD25REBXCY/i8vln1FOWI03HMvk9gswy9j1pzgUyyneq1aT9/jDjl4ih01RGw38MWEpNKVKQFwkI5EkdwjZ7C9SJ1XDvcbNDDJblRPgn/qxrl5lGsSMcE3HOXR8mTgfQBDbUV3KmVeqcMi3RCdHoh0YotN8d4Ezqst0eXVYbSJ+e8YsxSiH2gWl6LF9yU1fEIQGlC+bk6eIbVfnERYyT4VHZ9XIx8F+9bNhH1/XIsFDEeKmVC9n/+36ONy2XL54s9qbsU2dXUrlo3LjobCf1wYHfcZDZVrkhFZrHitFjmdDVUUByLjdgvqBx1Gwp1uuVDZLGNokZmqTB3BG7nhUaiG2X8p7J48Cn7PnbK92Y/5fqLIi0CmaexuddaPuS6mb2Lve6PpGFO2PZtqdrxPMelyzBPVDwS6Ab9M3GAZZtydtadZCknPJK4R7zvqq47OX73LlsDO6ByVUrh1VpVT6yiCDH1JmdyCMpKSDdiJG0UHCDhrnDkXJXAtOpGybJKQRs6mQDZQRDSRZkxbjMFxqz4GmshPo85jIcB8cdWLByp/2qTey/sd9A5o9cgLVmtdgST6p0ehkDXhVFGYZY6x8OAnX7owTcGimnOMp92EQ==
        CLEAN_DB_PORT: AgBsYIiaPHhv9Fpc9F/MZxmoGkwF2L87Fskc11EX1WbWvmC13oysTVZaEj0jR4e4NGBcBzQRlX/tsjDEx6E8ebAvVKgRwitVuKqTA61na23msUq5TTMlrV2kDxcR/Y/5n9YM49nIOp6YdTlIFMxAlWIznyZNxcFFLStvTMGGqibNP0ujqwxOt0m1He/7uMIcWlY2zGeC++vWl1hA7WsVtZ7/lUjUhoGdaHy7zVWsgrGEejGTzSV0TLfz9BSV+9RoPjXc4RiIn8YvV6CNAWAgIR0Lfk4oGkXftCIvrLAbTK9jH8YwbeD4A2eG1wIi4J5VZCO4OnGyWgrRHrVoUFd2ALPnSg5Khkj/sGKr6FGLpObuipdoIHCwYuLwZCx51m0NHgEXxkCoWHrhpHCcg5xtXhm0WMogpgxsgNBZLiZXn3XOgo7wrH9PoGZFeJwYXq/9Dy659PERI2It3WxZaRoiBpX4DT8uS4Uzfiruk82fB1wNo+mBAwkYEjU6UtxO91ro0K+eZEGtBJI8OXdZty1iEvBJQEd0Muse8rKgf+WlTvbZSBA7+J4yhoohxE6vcOc17Cq8PtsBgCuWQ9Nnhs4NlVwpDkabMH0HcXdYN4/5sjR0vEa/8PR0maoM2w0mryHhZztQMUexVE5adRw4ikC/QqvHw5BFUl5JRsssm3EwbO95hWV5vlWxCNYWvAuVRQlqM9spixs5
        CLEAN_DB_USER: AgAbhyMCO2AovFYoGSRTjAr2CO77/IzMJ04kCktyviBg00rSyn0Usw0LpQUPEusgEpvem+TvfdYpMl2cVq5WdNR1woyXX/0Rf+tCKcYypLAnluLqGzQdl0YgkCt60GnN29ZShGcGfvwEIW0VvWqtUbHBjTc1eDecuC3mnDc7XXjnYK077bQpHYKx6BVpzvpF6zXVoeG637RI8F3spMNWkh2CBUV9cfT41IrrCoBmUj6knH0OACW2jmje9A/OblaD4TtWm/tCTmFZxLcWcD9LR9IzEWD374RdbZdkuIjd3twAu+U5HGrCgUD0WcSFkWLfGx3ZGbTNsMBgpqAE2o24X96muztbZw7f/jmqEiuH2xXZopwXKFy2rcty1kwELKMOznOyaCi5BKiGGOeL6kW0XNjYsOXUKrpEkI7F3LAvPQMI9NAgOb1jqug/JHQ4u8tKHNc0oxoB3VlcdtBDeu3z5FvyfzLn5ZS3rHOD+UyXsvGMHirT5wGmqYz5GOUf3pof9ZFzQMloJyP4+kQuQpFKtjMm48uHDCLG/m4QYesq028Kw/bSNTMNes79HQ/5ywMkdaThs0PkYfwvt7NR8J2FMLGo0s4QnNXWNxXNYDGwJzhVfrkQsh7iehh/wq7QNGJ3Uz5IlmujLepuWZrykEU037DxR+uv9loHGPEBGVPtzuFghR+nQ+AF0Y8NfCFWXpuSsyt6TmffIbdP/A==
        DATABASE_URL: AgAs8Dmc/S764JPqOa07ABzthXg17Gclw3+c7IkDghX8CPvWRmU52zvXutNbsuiZ5mayeCNCBIWpX8rdbTQcBOS8heU9w0k8Ly1Hi/Eu7CwgO80F7OiNXOQEetmoMD+q4bBPg/XuI67Nf3H43S2Ne1plIRTNW0acOce6aynwbusYZZbe30SeZZrLh8PH53Gt6LnTY2/n4+1kLbFsoez29b4qhi8N1J4IbFH3bvMb9Jj2OO15GTXL3uSQTnbXtzmNOxTl1twVHql9LevIlBMssGPe40E0W7z55kAUzvstH6tGExJMAfVeGfaqEAcRurM9pS2TDgGCkyFkLcNKpUQ8U3mLDoQ0ir9MyPKJ2QKlYfJY1oaCN/Uny+6nx/x75wjsgqdv7IIoAVIzfBWmYhq2SLkJe0pvv7d1bdowHlmE6dRm6iLNC3chSG623LH0Hv/0rlHfUgg5sr9dpJwiYzUPZj5QQfRt06/ENh1nofPzDcPYlFiGVEeqZzywrqjvvYKfyE0rcg0+ZPYn8l3BaZ1UcWo/QUXuOnott8MTHn8ciwW1PN92Y88bCtHdbx+sl3pJ0uZuvzJht89fN2voEkQWfdVL9DD6puoZWwb0fYi2hsOXYHrRtWAoSeVB30QGDTaMc10l/AqgQga7iEY4IsSerp/Uoijf3xEDfBxBjFaZEtbWl7qzLWwN2ZY+YUqF9ktitNH1lfigQScBogXfn2SGpzJIXiwTyrGHvYEKmsSTokByZ0RGyGNXN2EyfUdvFmy0ytGl+Ub9uLN3+SGzqpwNlBUu5sPrYBmUySqJiEOy8tex9W2ggm+wWcYBlf9sP2YssKlT3kNRm8fi+Nq4DnzJlNSBH0Wb
      template:
        metadata:
          creationTimestamp: null
          name: moldb-cleandb-api
          namespace: openenzymedb
        type: Opaque




